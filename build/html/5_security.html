

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Security &mdash; Universal Scalable Firmware (USF)  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Debug" href="6_debug.html" />
    <link rel="prev" title="4. Runtime" href="4_runtime.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Universal Scalable Firmware (USF)
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="revision_history.html">Revision History</a></li>
<li class="toctree-l1"><a class="reference internal" href="disclaimers.html">Notices and Disclaimers</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1_terminology.html">1. Universal Scalable Firmware (USF) Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_universal_payload.html">2. Universal Payload</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_platform_orchestration_layer.html">3. Platform Orchestration Layer (POL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_runtime.html">4. Runtime</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#security-overview">5.1. Security Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#firmware-resiliency-protection">5.1.1. Firmware Resiliency - Protection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#critical-resource-lock-hardware">5.1.1.1. Critical Resource Lock (hardware)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#critical-service-close-software">5.1.1.2. Critical Service Close (software)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#critical-resource-access">5.1.1.3. Critical Resource Access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update">5.1.1.4. Update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#firmware-resiliency-detection">5.1.2. Firmware Resiliency - Detection</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#secure-boot-verified-boot">5.1.2.1. Secure Boot (verified boot)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-configuration-data-verification">5.1.2.2. Secure Configuration (data verification)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#firmware-resiliency-recovery">5.1.3. Firmware Resiliency - Recovery</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#recovery-trigger">5.1.3.1. Recovery trigger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#known-good-image">5.1.3.2. Known good image</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#measurment-and-attestation">5.1.4. Measurment and Attestation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#oem-component-measurement">5.1.4.1. OEM Component Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fsp-measurement">5.1.4.2. FSP Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#device-measurement">5.1.4.3. Device Measurement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#universal-payload-measurement">5.1.4.4. Universal Payload Measurement</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dma-protection">5.1.5. DMA Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cryptography-agility">5.1.6. Cryptography Agility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vulnerability-mitigation-strategy">5.2. Vulnerability Mitigation Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eliminate-vulnerability">5.2.1. Eliminate Vulnerability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#minimize-smi-handler">5.2.1.1. Minimize SMI handler</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minimize-uefi-variable">5.2.1.2. Minimize UEFI variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="#adopt-firmware-security-best-practice">5.2.1.3. Adopt Firmware Security Best Practice</a></li>
<li class="toctree-l4"><a class="reference internal" href="#consider-side-channel-mitigation">5.2.1.4. Consider Side Channel Mitigation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#type-safe-programming-language">5.2.1.5. Type Safe Programming Language</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#break-exploitation">5.2.2. Break Exploitation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-execution-prevention-dep">5.2.2.1. Data Execution Prevention (DEP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#control-flow-guard-cfg">5.2.2.2. Control Flow Guard (CFG)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#address-space-layout-randomization-aslr">5.2.2.3. Address Space Layout Randomization (ASLR)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#contain-damage">5.2.3. Contain Damage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deprevilege-execution">5.2.3.1. Deprevilege Execution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#limit-attack-window">5.2.4. Limit Attack Window</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#live-patching">5.2.4.1. Live Patching</a></li>
<li class="toctree-l4"><a class="reference internal" href="#firmware-component-manifest">5.2.4.2. Firmware Component Manifest</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="6_debug.html">6. Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="7_yaml_boot_configuration.html">7. YAML Format Boot Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_scalable_fsp.html">8. Scalable FSP</a></li>
<li class="toctree-l1"><a class="reference internal" href="9_bootloader_payloads.html">9. Bootloader Payloads</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Universal Scalable Firmware (USF)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">5. </span>Security</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="security">
<span id="id1"></span><h1><span class="section-number">5. </span>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<div class="section" id="security-overview">
<h2><span class="section-number">5.1. </span>Security Overview<a class="headerlink" href="#security-overview" title="Permalink to this headline">¶</a></h2>
<p>There are various security considerations for the POL, sFSP, and the
payloads. This section will describe the various overall concerns and
technology specific aspects.</p>
<div class="section" id="firmware-resiliency-protection">
<h3><span class="section-number">5.1.1. </span>Firmware Resiliency - Protection<a class="headerlink" href="#firmware-resiliency-protection" title="Permalink to this headline">¶</a></h3>
<div class="section" id="critical-resource-lock-hardware">
<h4><span class="section-number">5.1.1.1. </span>Critical Resource Lock (hardware)<a class="headerlink" href="#critical-resource-lock-hardware" title="Permalink to this headline">¶</a></h4>
<p>The platform shall always lock the important resource before it exits
the platform manufacture phase.</p>
<p>The important resource includes but is not limited to flash part, SMRAM,
SMRR, silicon register such as lockable BAR register,</p>
</div>
<div class="section" id="critical-service-close-software">
<h4><span class="section-number">5.1.1.2. </span>Critical Service Close (software)<a class="headerlink" href="#critical-service-close-software" title="Permalink to this headline">¶</a></h4>
<p>The platform shall always close the service that may impact the system
resource.</p>
<p>The service includes but is not limited to SMM registration service,
flash update service.</p>
</div>
<div class="section" id="critical-resource-access">
<h4><span class="section-number">5.1.1.3. </span>Critical Resource Access<a class="headerlink" href="#critical-resource-access" title="Permalink to this headline">¶</a></h4>
<p>The platform shall only allow the critical resource access in the
trusted execution environment such as SMM.</p>
</div>
<div class="section" id="update">
<span id="update-1"></span><h4><span class="section-number">5.1.1.4. </span>Update<a class="headerlink" href="#update" title="Permalink to this headline">¶</a></h4>
<p>The platform shall only allow firmware update only in the trusted
execution environment such as SMM, or before existing the platform
manufacture phase.</p>
<p>The update must check the secure version number to prevent rollback.</p>
</div>
</div>
<div class="section" id="firmware-resiliency-detection">
<h3><span class="section-number">5.1.2. </span>Firmware Resiliency - Detection<a class="headerlink" href="#firmware-resiliency-detection" title="Permalink to this headline">¶</a></h3>
<div class="section" id="secure-boot-verified-boot">
<h4><span class="section-number">5.1.2.1. </span>Secure Boot (verified boot)<a class="headerlink" href="#secure-boot-verified-boot" title="Permalink to this headline">¶</a></h4>
<p>The platform shall enable secure boot. The early boot component shall
verify the next component.</p>
<p>Care must be taken for Time-of-check/Time-of-use (TOC/TOU) attack.</p>
<p>The early component shall copy the next component to a trusted execution
environment, verify and use.</p>
<p>Please refer to <a class="reference external" href="https://tianocore-docs.github.io/Understanding_UEFI_Secure_Boot_Chain/draft/">Understanding the UEFI Secure Boot Chain</a></p>
</div>
<div class="section" id="secure-configuration-data-verification">
<h4><span class="section-number">5.1.2.2. </span>Secure Configuration (data verification)<a class="headerlink" href="#secure-configuration-data-verification" title="Permalink to this headline">¶</a></h4>
<p>If the configuration has security property, such as lock/unlock policy.
It shall be protected and verified.</p>
<p>The secure configuration may be treated as code and verified together
with secure boot.</p>
<p>Or the secure configuration may be protected by the variable
enhancement, such as RPMB or RPMC.</p>
</div>
</div>
<div class="section" id="firmware-resiliency-recovery">
<h3><span class="section-number">5.1.3. </span>Firmware Resiliency - Recovery<a class="headerlink" href="#firmware-resiliency-recovery" title="Permalink to this headline">¶</a></h3>
<div class="section" id="recovery-trigger">
<h4><span class="section-number">5.1.3.1. </span>Recovery trigger<a class="headerlink" href="#recovery-trigger" title="Permalink to this headline">¶</a></h4>
<p>A platform should have a watchdog to auto trigger recovery process
automatically. Otherwise, it should notify the end user that a manual
recovery is required.</p>
</div>
<div class="section" id="known-good-image">
<h4><span class="section-number">5.1.3.2. </span>Known good image<a class="headerlink" href="#known-good-image" title="Permalink to this headline">¶</a></h4>
<p>The recovery process may load a known good image. The known good image
itself shall be protected and follow the detection flow.</p>
<p>The known good image shall be up to date as well, to resist rollback
attack – recovery to an old known bad image.</p>
</div>
</div>
<div class="section" id="measurment-and-attestation">
<h3><span class="section-number">5.1.4. </span>Measurment and Attestation<a class="headerlink" href="#measurment-and-attestation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="oem-component-measurement">
<h4><span class="section-number">5.1.4.1. </span>OEM Component Measurement<a class="headerlink" href="#oem-component-measurement" title="Permalink to this headline">¶</a></h4>
<p>The platform shall follow <a class="reference external" href="https://trustedcomputinggroup.org/resource/pc-client-specific-platform-firmware-profile-specification/">TCG PC Client Platform Firmware Profile</a>
if TPM-based measured boot is enabled. The early boot component shall
measure the next component before transfer control to it, to create a
trust chain.</p>
<p>Please refer to <a class="reference external" href="https://tianocore-docs.github.io/edk2-TrustedBootChain/release-1.00/edk2-TrustedBootChain-release-1.00.pdf">Understanding the Trusted Boot Chain Implementation</a></p>
<p>The platform shall follow TCG specification to measure all required
component. For example, the platform shall measure every boot component.
The platform shall measure any security-related boot configuration.</p>
</div>
<div class="section" id="fsp-measurement">
<h4><span class="section-number">5.1.4.2. </span>FSP Measurement<a class="headerlink" href="#fsp-measurement" title="Permalink to this headline">¶</a></h4>
<p>The platform shall follow <a class="reference external" href="https://cdrdv2.intel.com/v1/dl/getContent/644001">FSP measurement and attestation</a>
to record the measurement for FSP binary.</p>
</div>
<div class="section" id="device-measurement">
<h4><span class="section-number">5.1.4.3. </span>Device Measurement<a class="headerlink" href="#device-measurement" title="Permalink to this headline">¶</a></h4>
<p>The platform shall follow <a class="reference external" href="https://www.dmtf.org/dsp/DSP0274">DMTF Security Protocol and Data Model (SPDM) Specification</a>
to record the measurement for the devices.</p>
</div>
<div class="section" id="universal-payload-measurement">
<h4><span class="section-number">5.1.4.4. </span>Universal Payload Measurement<a class="headerlink" href="#universal-payload-measurement" title="Permalink to this headline">¶</a></h4>
<p>The platform shall create a standalone event log for the universal payload.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Component</p></th>
<th class="head"><p>PCR</p></th>
<th class="head"><p>Event Type</p></th>
<th class="head"><p>Event Data</p></th>
<th class="head"><p>Event Log</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>UniversalPayload binary</p></td>
<td><p>0 (if it is part of OEM binary) or 2 (if it is treated as second phase loader)</p></td>
<td><p>EV_EFI_PLATFORM_FIRMWARE_BLOB2</p></td>
<td><p>UniversalPayload binary</p></td>
<td><p>EFI_PLATFORM_FIRMWARE_BLOB2 structure (descriptor: “UniversalPayload”)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
</div>
<div class="section" id="dma-protection">
<h3><span class="section-number">5.1.5. </span>DMA Protection<a class="headerlink" href="#dma-protection" title="Permalink to this headline">¶</a></h3>
<p>The platform shall enable IOMMU based DMA protection.</p>
<p>For example, <a class="reference external" href="https://software.intel.com/sites/default/files/managed/8d/88/intel-whitepaper-using-iommu-for-dma-protection-in-uefi.pdf">Using IOMMU for DMA Protection in UEFI Firmware</a>.</p>
</div>
<div class="section" id="cryptography-agility">
<h3><span class="section-number">5.1.6. </span>Cryptography Agility<a class="headerlink" href="#cryptography-agility" title="Permalink to this headline">¶</a></h3>
<p>A firmware infrastructure shall allow the implementation to choose different cryptographic algorithms, to compliant with different standards. This is called Cryptography agility.
TPM2.0 standard is a good example. A TPM2.0 device may support SHA256, SHA384, SM3_256, or future algorithms such as SHA3_256 or SHA3_384.</p>
<p>Below table shows the supported crypto algorithms.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Standard</p></th>
<th class="head"><p>Supported Algorithm</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>TCG - <a class="reference external" href="https://trustedcomputinggroup.org/resource/tcg-efi-protocol-specification/">EFI Protocol</a></p></td>
<td><p>SHA1/SHA-{256,384,512}/SM3</p></td>
</tr>
<tr class="row-odd"><td><p>IETF - <a class="reference external" href="https://datatracker.ietf.org/doc/rfc8446/">TLS 1.3</a></p></td>
<td><p>TLS Cipher Suite – for negotiation</p></td>
</tr>
<tr class="row-even"><td><p>DMTF - <a class="reference external" href="https://www.dmtf.org/sites/default/files/standards/documents/DSP0274_1.1.1.pdf">SPDM 1.1</a></p></td>
<td><p>RSA{SSA,PSS}_{2048,3072,4096}/ECDSA_P{256,384,521}+{SHA,SHA3}_{256,384,512}</p></td>
</tr>
<tr class="row-odd"><td><p>PCI-SIG – <a class="reference external" href="https://pcisig.com/specifications">CMA (Component Measurement and Authentication)</a></p></td>
<td><p>RSASSA_3072/ECDSA_P{256,384} + SHA{256,384}</p></td>
</tr>
<tr class="row-even"><td><p>UEFI - <a class="reference external" href="https://uefi.org/sites/default/files/resources/UEFI_Spec_2_9_2021_03_18.pdf">UEFI 2.9</a></p></td>
<td><p>RSA2048 (PKCS1_1.5) + SHA256</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Below table shows the minimal requirement.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Standard</p></th>
<th class="head"><p>Minimal Requirement</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://apps.nsa.gov/iaarchive/programs/iad-initiatives/cnsa-suite.cfm">Commercial National Security Algorithm Suite (CNSA Suite Guide)</a></p></td>
<td><p>SHA384, RSAPSS_3072/ECDSA_P384</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://www.cesa.cn/news.aspx?id=bgHZbw0110I=&amp;t=%E9%80%9A%E7%9F%A5%E5%85%AC%E5%91%8A">PRC CESA Server BIOS Requirement</a></p></td>
<td><p>SHA256/SM3, RSA_2048/SM2, ECDSA_256/SM2</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://developer.arm.com/documentation/den0006/latest">ARM Trusted Board Boot Requirements Client (TBBR-CLIENT) for A profile</a></p></td>
<td><p>AES_128, SHA256, ECDSA_256 (RSAPSS_2048)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.arm.com/-/media/Arm%20Developer%20Community/PDF/PSA/DEN0083_PSA_TBSA-M_1.0-bet2.pdf?revision=95776bd7-b790-48f0-bb18-ee064fb381ad">ARM Platform Security Architecture (PSA) Trusted Base System Architecture (TBSA) for M profile</a></p></td>
<td><p>AES_128, SHA256, ECDSA_256, RSA_3072</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.google.com/document/d/1Se1Dd-raIZhl_xV3MnECeuu_I0nF-keg4kqXyK4k4Wc/edit#heading=h.5z2d7x9gbhk0">OCP Secure Boot</a></p></td>
<td><p>SHA384, RSAPSS_3072/ECDSA_P384</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Below table shows the algorithm usage.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Feature</p></th>
<th class="head"><p>Algorithm</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://link.springer.com/chapter/10.1007/978-1-4842-0070-4_5">coreboot – Google Binary Blob (GBB) firmware keys</a></p></td>
<td><p>RSA 8192 + SHA512</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://developer.ibm.com/technologies/linux/articles/protect-system-firmware-openpower/">IBM Power Secure Boot</a></p></td>
<td><p>ECDSA (512 bit) + SHA512</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/windows-secure-boot-key-creation-and-management-guidance#12-public-key-cryptography">MSFT Secure Boot Key</a></p></td>
<td><p>RSA 2048 + SHA256</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>A firmware should start considering Post Quantum Cryptography Algorithm.
In 2019, NIST Stateful Hash-Based Signatures (<a class="reference external" href="https://csrc.nist.gov/projects/stateful-hash-based-signatures">HBS</a>) projects published <a class="reference external" href="https://csrc.nist.gov/publications/detail/sp/800-208/final">NIST SP 800-208</a> for the image signing in secure boot and secure update use case.
In 2022, NIST Post Quantum Cryptography (<a class="reference external" href="https://csrc.nist.gov/Projects/post-quantum-cryptography">PQC</a>) projects announced the <a class="reference external" href="https://csrc.nist.gov/Projects/post-quantum-cryptography/selected-algorithms-2022">Selected Algorithms 2022</a> for general purpose digital signature and Public-key Encryption / Key-establishment.
In 2022, NSA released the <a class="reference external" href="https://www.nsa.gov/Press-Room/News-Highlights/Article/Article/3148990/nsa-releases-future-quantum-resistant-qr-algorithm-requirements-for-national-se/">Commercial National Security Algorithm Suite 2.0 (CNSA 2.0) Cybersecurity Advisory (CSA)</a>, which includes the quantum resistant algorithms.</p>
<p>Below table shows the post quantum algorithms.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Usage</p></th>
<th class="head"><p>Algorithm</p></th>
<th class="head"><p>Specification</p></th>
<th class="head"><p>Approved by</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Image Signing (secure boot, secure update)</p></td>
<td><p>Leighton-Micali Signature (LMS) - <a class="reference external" href="https://www.rfc-editor.org/rfc/rfc8554">RFC8554</a></p></td>
<td><p><a class="reference external" href="https://csrc.nist.gov/publications/detail/sp/800-208/final">NIST SP 800-208</a></p></td>
<td><p>NIST, NSA</p></td>
</tr>
<tr class="row-odd"><td><p>Image Signing (secure boot, secure update)</p></td>
<td><p>Xtended Merkle Signature Scheme (XMSS) - <a class="reference external" href="https://www.rfc-editor.org/rfc/rfc8391">RFC8391</a></p></td>
<td><p><a class="reference external" href="https://csrc.nist.gov/publications/detail/sp/800-208/final">NIST SP 800-208</a></p></td>
<td><p>NIST, NSA</p></td>
</tr>
<tr class="row-even"><td><p>Public-key Encryption and Key-establishment</p></td>
<td><p><a class="reference external" href="https://pq-crystals.org/">CRYSTALS-KYBER</a></p></td>
<td><p>TBD</p></td>
<td><p>NIST, NSA</p></td>
</tr>
<tr class="row-odd"><td><p>General Purpose Digital Signature</p></td>
<td><p><a class="reference external" href="https://pq-crystals.org/">CRYSTALS-DILITHIUM</a></p></td>
<td><p>TBD</p></td>
<td><p>NIST, NSA</p></td>
</tr>
<tr class="row-even"><td><p>General Purpose Digital Signature</p></td>
<td><p><a class="reference external" href="https://falcon-sign.info/">FALCON</a></p></td>
<td><p>TBD</p></td>
<td><p>NIST</p></td>
</tr>
<tr class="row-odd"><td><p>General Purpose Digital Signature</p></td>
<td><p><a class="reference external" href="https://sphincs.org/">SPHINCS+</a></p></td>
<td><p>TBD</p></td>
<td><p>NIST</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The firmware related timeline would be:</p>
<ol class="arabic simple">
<li><p>Software and Firmware Signing: prefer CNSA 2.0 by 2025, exclusively use by 2030.</p></li>
<li><p>Web browsers/servers and cloud services: prefer CNSA 2.0 by 2025, exclusively use by 2033.</p></li>
</ol>
<p>A firmware infrastructure shall consider crypto-agile support for two purposes:</p>
<ol class="arabic simple">
<li><p>To support more industry standard cryptographic algorithms, which may be used in some firmware implementation, such as SHA3, SM3, SM2, etc.</p></li>
<li><p>To support quantum safe cryptographic algorithm and hybrid mode, such as XMSS or LMS digital signature algorithm, etc.</p></li>
</ol>
</div>
</div>
<div class="section" id="vulnerability-mitigation-strategy">
<h2><span class="section-number">5.2. </span>Vulnerability Mitigation Strategy<a class="headerlink" href="#vulnerability-mitigation-strategy" title="Permalink to this headline">¶</a></h2>
<p>The platform should make the attacker difficult to find, exploit and leverage the vulnerabilities.</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tactics</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Eliminate Vulnerability</p></td>
<td><p>Reduce Attack Surface. Dont Use Weak Cryptography Algorithm. Use Type Safe Programming Language.</p></td>
<td><p>Remove Unnecessary Interface, such as SMI handler, UEFI variable. Adopt Firmware Security Best Practice. Consider Side Channel Attack. Cryptography Agility. Use Rust.</p></td>
</tr>
<tr class="row-odd"><td><p>Break Exploitation</p></td>
<td><p>Data Execution Prevention. Control Flow Guard. Address Space Layout Randomization. Secure Boot.</p></td>
<td><p>Non-executable Data Page. Read-only code page. Stack Cookie. Intel CET. ASLR in DXE/SMM.</p></td>
</tr>
<tr class="row-even"><td><p>Contain Damage</p></td>
<td><p>Deprevilege</p></td>
<td><p>Ring-3 Option ROM. Ring-3 OEM SMM.</p></td>
</tr>
<tr class="row-odd"><td><p>Limit Attack Window</p></td>
<td><p>Firmware Resiliency. Measurement and Attestation.</p></td>
<td><p>Live Patching Runtime Component. Firmware Component Manifest.</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="section" id="eliminate-vulnerability">
<h3><span class="section-number">5.2.1. </span>Eliminate Vulnerability<a class="headerlink" href="#eliminate-vulnerability" title="Permalink to this headline">¶</a></h3>
<p>First, a platform should try to remove any attack surfaces and eliminate the potential vulnerablity.</p>
<div class="section" id="minimize-smi-handler">
<h4><span class="section-number">5.2.1.1. </span>Minimize SMI handler<a class="headerlink" href="#minimize-smi-handler" title="Permalink to this headline">¶</a></h4>
<p>In a system firmware, the SMI Handler is the most critical attack surface, because the SMM code has highest privilege. A platform should use <a class="reference external" href="https://github.com/tianocore/tianocore.github.io/wiki/SMI-handler-profile-feature">SMI Handler Profile</a> to evaluate if the exposed SMI handlers are necessary.</p>
</div>
<div class="section" id="minimize-uefi-variable">
<h4><span class="section-number">5.2.1.2. </span>Minimize UEFI variable<a class="headerlink" href="#minimize-uefi-variable" title="Permalink to this headline">¶</a></h4>
<p>Every UEFI variable is an attack surface, because the attacker can use UEFI API to modify it. A platform should review all UEFI variable and evaluate if it is really needed.</p>
</div>
<div class="section" id="adopt-firmware-security-best-practice">
<h4><span class="section-number">5.2.1.3. </span>Adopt Firmware Security Best Practice<a class="headerlink" href="#adopt-firmware-security-best-practice" title="Permalink to this headline">¶</a></h4>
<p>The platform should follow the existing firmware security best practice, such as <a class="reference external" href="https://github.com/tianocore-docs/Docs/raw/master/White_Papers/A_Tour_Beyond_BIOS_Security_Design_Guide_in_EDK_II.pdf">EDKII Secure Design Guide</a>, <a class="reference external" href="https://tianocore-docs.github.io/EDK_II_Secure_Coding_Guide/draft/">EDKII Secure Coding Guide</a>, <a class="reference external" href="https://tianocore-docs.github.io/EDK_II_Secure_Code_Review_Guide/draft/">EDKII Secure Code Review Guide</a>.</p>
<p>Other EDKII security related document can be found at <a class="reference external" href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II-Security-White-Papers">EDKII Security White Papers</a>.</p>
</div>
<div class="section" id="consider-side-channel-mitigation">
<h4><span class="section-number">5.2.1.4. </span>Consider Side Channel Mitigation<a class="headerlink" href="#consider-side-channel-mitigation" title="Permalink to this headline">¶</a></h4>
<p>A platform shall follow <a class="reference external" href="https://www.intel.com/content/www/us/en/developer/articles/technical/software-security-guidance/technical-documentation/host-firmware-speculative-side-channel-mitigation.html">Host Firmware Speculative Execution Side Channel Mitigation</a>.</p>
<ol class="arabic simple">
<li><p>LFENCE after validation of untrusted data but before use</p></li>
<li><p>RSB stuffing before RSM</p></li>
</ol>
</div>
<div class="section" id="type-safe-programming-language">
<h4><span class="section-number">5.2.1.5. </span>Type Safe Programming Language<a class="headerlink" href="#type-safe-programming-language" title="Permalink to this headline">¶</a></h4>
<p>An analysis has found that 50% of the open source BIOS security bugs are due to buffer overflows and integer overflows. There are a variety of tools and techniques to prevent these bugs, by identifying and eliminating the vulnerability or by ensuring the vulnerability is not exploitable. Alternatively, instead of providing an ever-increasing set of guidance and tools to address these bugs, we could seek ways to avoid introducing the bugs in the first place.  An emerging approach is to use memory-safe programming languages.</p>
<p><a class="reference external" href="https://www.rust-lang.org/">Rust</a> is a promising new programming language that can eliminate memory safety issues at compile time. Engineers at Microsoft have made a <a class="reference external" href="https://msrc-blog.microsoft.com/2019/07/16/a-proactive-approach-to-more-secure-code/">case</a> for using memory-safe languages like Rust. A number of firmware and embedded projects are embracing Rust, including <a class="reference external" href="https://github.com/oreboot/oreboot">oreboot</a> system firmware, RISC-V <a class="reference external" href="https://github.com/rustsbi/rustsbi">rustsbi</a> and <a class="reference external" href="https://github.com/tock/tock">tock</a> embedded OS. Rust also supports UEFI toolchains, x86-64-unknown-uefi and i686-unknown-uefi, which can be used to generate a UEFI executable directly. There are UEFI related Rust projects including <a class="reference external" href="https://github.com/r-efi/r-efi">r-efi</a> and <a class="reference external" href="https://github.com/rust-osdev/uefi-rs">uefi-rs</a>.</p>
<p>EDKII firmware may use Rust to build a component with <a class="reference external" href="https://github.com/jyao1/edk2/tree/edkii-rust/RustPkg">RustPkg</a>. A lightweight pure <a class="reference external" href="https://github.com/jyao1/rust-firmware">rust-firmware</a> is also possible to boot the system with Intel FSP.</p>
<a class="reference internal image-reference" href="_images/image7.png"><img alt="_images/image7.png" src="_images/image7.png" style="width: 5in; height: 2.8125in;" /></a>
<p><strong>Figure 14 A pure Rust-firmware</strong></p>
<p>Experimentation so far has shown that, with compile-time checking, Rust can eliminate uninitialized variable, use after free, and double free vulnerabilities.  With runtime checking, Rust can help break exploitation of memory boundary check and integer overflow check issues.</p>
<p>In addition to memory safety benefits, Rust also has good software engineering tools support and is interoperable with C.  With Rust, developers can easily generate documents (cargo doc), perform unit tests (cargo test), fix coding style issues (cargo fmt), do static analysis (cargo clippy), and more.  All those tools are integrated into the Rust cargo package manager. Rust can even get faster performance than C because the code can be determined at compile time, saving time at runtime execution.</p>
</div>
</div>
<div class="section" id="break-exploitation">
<h3><span class="section-number">5.2.2. </span>Break Exploitation<a class="headerlink" href="#break-exploitation" title="Permalink to this headline">¶</a></h3>
<p>If a platform may contain the vulnerablities, the platform should adopt defence in deptch to break the exploitation. <a class="reference external" href="https://edk2-docs.gitbook.io/a-tour-beyond-bios-memory-protection-in-uefi-bios">Memory Protection in UEFI BIOS</a>, <a class="reference external" href="https://tianocore-docs.github.io/ATBB-Mitigate_Buffer_Overflow_in_UEFI/draft/">Mitigate Buffer Overflow in UEFI</a>, <a class="reference external" href="https://github.com/tianocore-docs/Docs/raw/master/White_Papers/A_Tour_Beyond_BIOS_Secure_SMM_Communication.pdf">Secure SMM Communication</a>, and <a class="reference external" href="https://github.com/tianocore/tianocore.github.io/wiki/CET-in-SMM">CET in SMM</a> provides guideline on how to mitigate those threats.</p>
<div class="section" id="data-execution-prevention-dep">
<h4><span class="section-number">5.2.2.1. </span>Data Execution Prevention (DEP)<a class="headerlink" href="#data-execution-prevention-dep" title="Permalink to this headline">¶</a></h4>
<p>A platform should set data memory to be non-executable and code memory to be read-only. As such, the data page (including stack, heap, global data, and usable memory) cannot be executed. It is an efficient way to prevent code injection.</p>
</div>
<div class="section" id="control-flow-guard-cfg">
<h4><span class="section-number">5.2.2.2. </span>Control Flow Guard (CFG)<a class="headerlink" href="#control-flow-guard-cfg" title="Permalink to this headline">¶</a></h4>
<p>Control flow attack is feasiable even if the DEP is enabled. A platform may enable compiler feature (stack cookie) or use the CPU feature such as Intel Control Flow Enforcement Technology (CET) to guard the control flow.</p>
</div>
<div class="section" id="address-space-layout-randomization-aslr">
<h4><span class="section-number">5.2.2.3. </span>Address Space Layout Randomization (ASLR)<a class="headerlink" href="#address-space-layout-randomization-aslr" title="Permalink to this headline">¶</a></h4>
<p>ASLR is makes it more difficult for an attacker to predict target addresses even if there is vulnerability in the program. The randomization technology can include shuffling, most likely for the image, or shifting, most likely for the data.</p>
</div>
</div>
<div class="section" id="contain-damage">
<h3><span class="section-number">5.2.3. </span>Contain Damage<a class="headerlink" href="#contain-damage" title="Permalink to this headline">¶</a></h3>
<p>If a platform does not have an efficient way to break the exploitation, the platform may consider to limit the damage in a small scope.</p>
<div class="section" id="deprevilege-execution">
<h4><span class="section-number">5.2.3.1. </span>Deprevilege Execution<a class="headerlink" href="#deprevilege-execution" title="Permalink to this headline">¶</a></h4>
<p>By default, the system firwmare execution environment is in ring-0. Platform may run untrusted component in a deprevileged environment ring-3.</p>
<p>For example, the UEFI firmware can run 3rd party option ROM in ring-3, a small SMM CPU code can run the OEM SMM driver in ring-3, etc.</p>
<p>If the vulnerabilities in option ROM or OEM SMM code are exploited, the damage will only be in the ring-3 component and will not impact the system.</p>
</div>
</div>
<div class="section" id="limit-attack-window">
<h3><span class="section-number">5.2.4. </span>Limit Attack Window<a class="headerlink" href="#limit-attack-window" title="Permalink to this headline">¶</a></h3>
<p>If a platform really has vulnerablity escaping from all defense and impact the system, we need patch it platform in time.</p>
<div class="section" id="live-patching">
<h4><span class="section-number">5.2.4.1. </span>Live Patching<a class="headerlink" href="#live-patching" title="Permalink to this headline">¶</a></h4>
<p>Live patching is trend in the industry. For example, Linux kernel implemented live patching of a running kernel.</p>
<p>The system firmware may consider using similar mechanims to patch the runtime component if there is.</p>
</div>
<div class="section" id="firmware-component-manifest">
<h4><span class="section-number">5.2.4.2. </span>Firmware Component Manifest<a class="headerlink" href="#firmware-component-manifest" title="Permalink to this headline">¶</a></h4>
<p>Before a firmware patch is deployed, an adiminstrator may need to know how many systems are impacted.</p>
<p>A platform may include many firmware components, which are from different sources. Now we need a way to collect those information. We define 2 category of firmwares in below table</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Sub-Type</p></th>
<th class="head"><p>Loader (Loaded/Measured/Authenticated by)</p></th>
<th class="head"><p>Location (Loaded from)</p></th>
<th class="head"><p>Execution Environment (Executed in)</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Type-I</p></td>
<td><p>I-A</p></td>
<td><p>Host</p></td>
<td><p>System Firmware</p></td>
<td><p>Host</p></td>
<td><p>BIOS, Intel FSP, CPU Microcode</p></td>
</tr>
<tr class="row-odd"><td><p>Type-I</p></td>
<td><p>I-B</p></td>
<td><p>Host</p></td>
<td><p>Peripheral Device</p></td>
<td><p>Host</p></td>
<td><p>PCI Option ROM</p></td>
</tr>
<tr class="row-even"><td><p>Type-II</p></td>
<td><p>II-A</p></td>
<td><p>Non-Host</p></td>
<td><p>Non-Host Firmware</p></td>
<td><p>Non-Host</p></td>
<td><p>BMC, EC, Intel CSME</p></td>
</tr>
<tr class="row-odd"><td><p>Type-II</p></td>
<td><p>II-B</p></td>
<td><p>Peripheral Device</p></td>
<td><p>Peripheral Device</p></td>
<td><p>Peripheral Device</p></td>
<td><p>NIC, NVMe, Graphic Card</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>We define 2 types of firmwares:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>Type-I firmware indicates the firmware loaded, measured, authenticated in host environment.</dt><dd><ul>
<li><p>Type-I-A indicates the one loaded from system firmware location, such as BIOS, FSP, CPU Microcode.</p></li>
<li><p>Type-I-B indicates the one loaded from peripheral device, such as PCI option ROM.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Type-II firmware indicates the firmware loaded, measured, authenticated not in host environment.</dt><dd><ul>
<li><p>Type-II-A indicates the one loaded from non-host firmware location, such as BMC, EC, Intel CSME.</p></li>
<li><p>Type-II-B indicates the one loaded from peripheral device, such as NIC, NVMe, Graphic Card.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>For Type-I firmware, the component provider may provide a reference integrity manifest (RIM) for this specific component.</p>
<p>Intel <a class="reference external" href="https://cdrdv2.intel.com/v1/dl/getContent/644001">FSP 2.x measurement and attesation</a> defines a mechanism to report FSP manifest according to TCG <a class="reference external" href="https://trustedcomputinggroup.org/resource/tcg-pc-client-reference-integrity-manifest-specification/">PC Client Reference Integrity Manifest Specification</a>. The RIM format could be <a class="reference external" href="https://csrc.nist.gov/projects/software-identification-swid/guidelines">SWID</a> or <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-sacm-coswid/">CoSWID</a>.</p>
<p>The universal payload should use SWID or CoSWID with below information:</p>
<blockquote>
<div><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Element</p></th>
<th class="head"><p>Attribute</p></th>
<th class="head"><p>Required</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Software Identity</p></td>
<td><p>Name</p></td>
<td><p>Required</p></td>
<td><p>Name of the Universal payload</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Version</p></td>
<td><p>Required</p></td>
<td><p>Version of the Universal payload</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>TagId</p></td>
<td><p>Required</p></td>
<td><p>GUID to identify the Universal payload</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>TagVersion</p></td>
<td><p>Required</p></td>
<td><p>Version to the tag, “0”</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Corpus</p></td>
<td><p>Optional</p></td>
<td><p>“FALSE”</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Patch</p></td>
<td><p>Optional</p></td>
<td><p>“FALSE” : Initial RIM. “TRUE” : Subsequential RIM</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Supplemental</p></td>
<td><p>Optional</p></td>
<td><p>“FALSE” : First RIM (e.g. primary RIM). “TRUE” : not firmst RIM (e.g. issued by System Integrator or Value Add Reseller)</p></td>
</tr>
<tr class="row-odd"><td><p>Entity</p></td>
<td><p>Name</p></td>
<td><p>Required</p></td>
<td><p>The entity that creates the Universal Payload, could be “USF”.</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>RegId</p></td>
<td><p>Optional</p></td>
<td><p>URI for the entity to create the Universal Payload, could be “<a class="reference external" href="https://github.com/UniversalScalableFirmware">https://github.com/UniversalScalableFirmware</a>”.</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Role</p></td>
<td><p>Required</p></td>
<td><p>“softwareCreator, tagCreator”</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Thumbprint</p></td>
<td><p>Required</p></td>
<td><p>digest of the signing certificate</p></td>
</tr>
<tr class="row-odd"><td><p>Link</p></td>
<td><p>Href rel= “installation media”</p></td>
<td><p>Optional</p></td>
<td><p>Download URL</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Href rel= “supersedes”, “patches”, “requires”</p></td>
<td><p>Optional</p></td>
<td><p>Link to previous RIM</p></td>
</tr>
<tr class="row-odd"><td><p>Meta</p></td>
<td><p>colloquialVersion</p></td>
<td><p>Required</p></td>
<td><p>Marketing version of the Universal Payload</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Edition</p></td>
<td><p>Required</p></td>
<td><p>Specification version of the Universal Payload</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Production</p></td>
<td><p>Required</p></td>
<td><p>Name of the Universal Payload</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Revision</p></td>
<td><p>Required</p></td>
<td><p>Revision of the Universal Payload</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>PayloadType</p></td>
<td><p>Optional</p></td>
<td><p>“Direct”</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>PlatformManufacturerStr</p></td>
<td><p>Required</p></td>
<td><p>Name of the Manufacturer</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>PlatformManufacturerId</p></td>
<td><p>Required</p></td>
<td><p>IANA identifier of the Manufacturer</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>PlatformModel</p></td>
<td><p>Required</p></td>
<td><p>Name of the Platform Model</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>PlatformVersion</p></td>
<td><p>Required</p></td>
<td><p>Version of the Platform</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>FirmwareManufacturerStr</p></td>
<td><p>Required</p></td>
<td><p>Name of the Firmware Manufacturer</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>FirmwareManufacturerId</p></td>
<td><p>Required</p></td>
<td><p>IANA identifier of the Firmware Manufacturer</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>FirmwareModel</p></td>
<td><p>Required</p></td>
<td><p>Name of the Firmware Model</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>FirmwareVersion</p></td>
<td><p>Required</p></td>
<td><p>Version of the Firmware</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>BindingSpec</p></td>
<td><p>Required</p></td>
<td><p>“RIMIM”</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>BindingSpecVersion</p></td>
<td><p>Required</p></td>
<td><p>“0.1”</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>pcURILocal</p></td>
<td><p>Optional</p></td>
<td><p>URI for this RIM in local device</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>pcURIGlobal</p></td>
<td><p>Optional</p></td>
<td><p>URI for this RIM on web</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>RIMLinkHash</p></td>
<td><p>Optional</p></td>
<td><p>Not needed for Base RIM</p></td>
</tr>
<tr class="row-odd"><td><p>Payload</p></td>
<td><p>File, Directory</p></td>
<td><p>Required</p></td>
<td><p>Location and File Name of the Universal Payload component</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Name</p></td>
<td><p>Required</p></td>
<td><p>Name of the Universal Payload component</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Size</p></td>
<td><p>Required</p></td>
<td><p>Size of the Universal Payload component</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Hash</p></td>
<td><p>Required</p></td>
<td><p>Hash of the Universal Payload component</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>supportRIMType</p></td>
<td><p>Optional</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>supportRIMFormat</p></td>
<td><p>Optional</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>supportRIMURIGlobal</p></td>
<td><p>Optional</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>At runtime, the system firmware records a specific component measurement entry, then the verifier can compare the measurement in the event log with the reference value in the RIM. Figure 15 shows the Type-I firmware component RIM concept.</p>
<a class="reference internal image-reference" href="_images/image20.png"><img alt="_images/image20.png" src="_images/image20.png" style="width: 5in; height: 2.8125in;" /></a>
<p><strong>Figure 15 Component Manifest for Type-I Firmware</strong></p>
<p>For Type-II firmware, the component provider may provide a device firmware manifest. The RIM format could be <a class="reference external" href="https://datatracker.ietf.org/doc/draft-birkholz-rats-corim/">CoMID</a></p>
<p>At runtime, the system firmware may use a standard way - <a class="reference external" href="https://www.dmtf.org/dsp/DSP0274">SPDM</a> protocol - to obtain the measurement from the device and put it into TPM PCR according to TCG <a class="reference external" href="https://trustedcomputinggroup.org/resource/pc-client-specific-platform-firmware-profile-specification/">PC Client Specific Platform Firmware Profile Specification</a>. The verifier can get the runtime value from the TCG event log and compare it with the reference value in the device RIM. Figure 16 shows the Type-II firmware component RIM concept.</p>
<a class="reference internal image-reference" href="_images/image21.png"><img alt="_images/image21.png" src="_images/image21.png" style="width: 5in; height: 2.8125in;" /></a>
<p><strong>Figure 16 Component Manifest for Type II Firmware</strong></p>
<p>A platform should have a way to report a list of manifest and collect the runtime firmware measurement. As such, we can know the detailed firmware component information on a given platform.</p>
<p>To support the supply chain, the platform vendor should follow
<a class="reference external" href="https://trustedcomputinggroup.org/resource/tcg-platform-certificate-profile/">TCG Platform Certificate Profile</a>,
<a class="reference external" href="https://trustedcomputinggroup.org/resource/tcg-pc-client-reference-integrity-manifest-specification/">TCG PC Client Reference Integrity Manifest</a>,
and <a class="reference external" href="https://trustedcomputinggroup.org/resource/tcg-pc-client-platform-firmware-integrity-measurement/">TCG PC Client Firmware Integrity Manifest</a>
to provide platform certificate and reference integrity manifest.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="6_debug.html" class="btn btn-neutral float-right" title="6. Debug" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="4_runtime.html" class="btn btn-neutral float-left" title="4. Runtime" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Content on this site is licensed under a Creative Commons Attribution 4.0 International license
      <span class="lastupdated">
        Last updated on Oct 07, 2022.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>